specVersion: 0.0.5
schema:
  file: ./schema.graphql
dataSources:
  # VeritasEscrow Contract
  - kind: ethereum
    name: VeritasEscrow
    network: matic # Polygon
    source:
      address: "0x0000000000000000000000000000000000000000" # Replace after deployment
      abi: VeritasEscrow
      startBlock: 0 # Replace with deployment block
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Trade
        - Dispute
        - User
      abis:
        - name: VeritasEscrow
          file: ./abis/VeritasEscrow.json
      eventHandlers:
        - event: TradeCreated(indexed bytes32,indexed address,indexed address,address,uint256,uint256)
          handler: handleTradeCreated
        - event: TradeAccepted(indexed bytes32,indexed address)
          handler: handleTradeAccepted
        - event: TradeDelivered(indexed bytes32,string)
          handler: handleTradeDelivered
        - event: TradeCompleted(indexed bytes32,uint256,uint256)
          handler: handleTradeCompleted
        - event: TradeCancelled(indexed bytes32,indexed address)
          handler: handleTradeCancelled
        - event: TradeExpired(indexed bytes32)
          handler: handleTradeExpired
        - event: DisputeRaised(indexed bytes32,indexed address,string)
          handler: handleDisputeRaised
        - event: DisputeResolved(indexed bytes32,indexed address,uint256)
          handler: handleDisputeResolved
        - event: TradeRated(indexed bytes32,indexed address,indexed address,uint256)
          handler: handleTradeRated
      file: ./src/escrow.ts

  # ReputationEngine Contract
  - kind: ethereum
    name: ReputationEngine
    network: matic
    source:
      address: "0x0000000000000000000000000000000000000000" # Replace after deployment
      abi: ReputationEngine
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - User
        - ReputationUpdate
      abis:
        - name: ReputationEngine
          file: ./abis/ReputationEngine.json
      eventHandlers:
        - event: ReputationUpdated(indexed address,uint256,uint256,uint256)
          handler: handleReputationUpdated
        - event: TradeRecorded(indexed bytes32,indexed address,indexed address,uint256,uint256,uint256)
          handler: handleTradeRecorded
        - event: DisputeResolved(indexed bytes32,indexed address,indexed address,uint256)
          handler: handleDisputeResolvedReputation
        - event: BadgeThresholdMet(indexed address,uint8,uint256,uint256)
          handler: handleBadgeThresholdMet
        - event: CrossChainReputationSynced(indexed address,indexed uint64,uint256,uint256)
          handler: handleCrossChainSync
      file: ./src/reputation.ts

  # VeritasSoulboundBadge Contract
  - kind: ethereum
    name: VeritasSoulboundBadge
    network: matic
    source:
      address: "0x0000000000000000000000000000000000000000" # Replace after deployment
      abi: VeritasSoulboundBadge
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Badge
        - User
      abis:
        - name: VeritasSoulboundBadge
          file: ./abis/VeritasSoulboundBadge.json
      eventHandlers:
        - event: BadgeMinted(indexed address,indexed uint256,uint8,uint256,uint256)
          handler: handleBadgeMinted
        - event: BadgeUpgraded(indexed address,indexed uint256,indexed uint256,uint8,uint8)
          handler: handleBadgeUpgraded
        - event: Locked(uint256)
          handler: handleLocked
      file: ./src/soulbound.ts
