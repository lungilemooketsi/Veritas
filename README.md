# Veritas Marketplace

A decentralized Web3 marketplace featuring:
- ðŸ¦ **Fiat-to-Crypto Onboarding** via Stripe Crypto Onramp
- ðŸŒ‰ **Cross-Chain Interoperability** via Chainlink CCIP
- ðŸŽ–ï¸ **Soulbound Token Reputation System** (EIP-5192)
- ðŸ”’ **Secure Escrow Trading**

## Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         VERITAS MARKETPLACE                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Next.js    â”‚  â”‚   Backend    â”‚  â”‚    The Graph         â”‚  â”‚
â”‚  â”‚   Frontend   â”‚â—„â”€â”¤   API        â”‚â—„â”€â”¤    Subgraph          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                 â”‚                      â”‚              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Smart Contracts                         â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  â”‚
â”‚  â”‚  â”‚  Escrow    â”‚ â”‚ Reputation â”‚ â”‚   SoulboundToken        â”‚â”‚  â”‚
â”‚  â”‚  â”‚  Contract  â”‚ â”‚  Engine    â”‚ â”‚   (EIP-5192)            â”‚â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  Blockchain Networks                      â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚   â”‚
â”‚  â”‚    â”‚ Polygon â”‚â—„â”€â”€â–ºâ”‚Arbitrum â”‚â—„â”€â”€â–ºâ”‚Ethereum â”‚             â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚   â”‚
â”‚  â”‚              Chainlink CCIP (Cross-Chain)                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    External Services                      â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚    â”‚ Stripe Crypto   â”‚    â”‚  Chainlink Price Feeds   â”‚   â”‚   â”‚
â”‚  â”‚    â”‚ Onramp (KYC)    â”‚    â”‚  & VRF                   â”‚   â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Project Structure

```
veritas/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ web/                    # Next.js Frontend
â”‚   â””â”€â”€ api/                    # Express Backend API
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ contracts/              # Solidity Smart Contracts
â”‚   â”œâ”€â”€ subgraph/               # The Graph Subgraph
â”‚   â””â”€â”€ shared/                 # Shared Types & Utils
â””â”€â”€ docs/                       # Documentation
```

## Tech Stack

| Component | Technology | Purpose |
|-----------|------------|---------|
| Network | Polygon / Arbitrum | Low gas fees, fast finality |
| Fiat Gateway | Stripe Crypto Onramp | User-friendly fiat conversion |
| Smart Contracts | Solidity + Hardhat | Escrow, Reputation, SBTs |
| Token Standard | EIP-5192 | Non-transferable reputation tokens |
| Indexing | The Graph | Fast reputation data queries |
| Frontend | Next.js 14 + wagmi + viem | Modern Web3 UX |
| Backend | Express + TypeScript | API & webhook handling |
| Cross-Chain | Chainlink CCIP | Secure asset bridging |

## Quick Start

### Prerequisites
- Node.js >= 18
- pnpm or npm
- MetaMask or compatible wallet
- Stripe account (for onramp)

### Installation

```bash
# Install dependencies
npm install

# Set up environment variables
cp .env.example .env.local

# Compile contracts
npm run compile

# Start development server
npm run dev
```

### Environment Variables

Create a `.env.local` file:

```env
# Blockchain
PRIVATE_KEY=your_deployer_private_key
POLYGON_RPC_URL=https://polygon-mainnet.g.alchemy.com/v2/YOUR_KEY
ARBITRUM_RPC_URL=https://arb-mainnet.g.alchemy.com/v2/YOUR_KEY

# Stripe
STRIPE_SECRET_KEY=sk_test_...
STRIPE_PUBLISHABLE_KEY=pk_test_...
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_...

# The Graph
GRAPH_API_KEY=your_graph_api_key
SUBGRAPH_ENDPOINT=https://api.thegraph.com/subgraphs/name/...

# App
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

## Core Workflows

### 1. User Onboarding Flow
```
User â†’ Stripe KYC â†’ Purchase USDC â†’ Wallet Funded â†’ Ready to Trade
```

### 2. Trading Flow
```
Buyer Creates Order â†’ Funds Locked in Escrow â†’ Seller Delivers â†’ 
Buyer Confirms â†’ Funds Released â†’ Reputation Updated
```

### 3. Reputation Minting Flow
```
50+ Trades + 4.8+ Rating â†’ Threshold Met â†’ SBT Auto-Minted â†’ 
Badge Visible On-Chain
```

## Smart Contract Addresses

### Polygon Mainnet
| Contract | Address |
|----------|---------|
| VeritasEscrow | `TBD` |
| ReputationEngine | `TBD` |
| SoulboundBadge | `TBD` |

### Arbitrum One
| Contract | Address |
|----------|---------|
| VeritasEscrow | `TBD` |
| ReputationEngine | `TBD` |
| SoulboundBadge | `TBD` |

## License

MIT License - see [LICENSE](LICENSE) for details.
